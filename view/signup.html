{{define "signup"}} {{template "header"}}
<div class="signup-wrapper">
    <div class="signup-container">
        <h3>Signup Forum-X</h3>
        <!-- //onsubmit="event.preventDefault();" -->
        <form action="/signup" method="POST" enctype="multipart/form-data" autocomplete="on">
            <input type="text" id="fullname" name="fullname" placeholder="Full Name" required>
            <input type="text" id="username" name="username" placeholder="Username" required>
            <input id="email" type="email" name="email" placeholder="Email" required>
            <input type="number" id="age" name="age" placeholder="Age" min="16" max="80">
            <input type="hidden" id="authType" name="authType" value="default">

            <select name="sex" id="sex">
                <option value="male">Male</option>
                <option value="female">Female</option>
            </select>

            <select name="city" id="city">
                <option value="Almaty">Almaty</option>
                <option value="Astana">Astana</option>
                <option value="Karaganda">Karaganda</option>
                <option value="Shymkent">Shymkent</option>
                <option value="Aktau">Aktau</option>
                <option value="Atyrau">Atyrau</option>
                <option value="Taraz">Taraz</option>
                <option value="Kokshetau">Kokshetau</option>
                <option value="Semey">Semey</option>
                <option value="Uralsk">Uralsk</option>
                <option value="Pavlodar">Pavlodar</option>
                <option value="Petropavlsk">Petropavlsk</option>
                <option value="Kyzyldorda">Kyzyldorda</option>
                <option value="Ust-kamenogorsk">Ust-kamenogorsk</option>
            </select>

            <input id="password1" type="password" name="password" placeholder="Password" required>
            <input id="password2" type="password" name="password" placeholder="Repeat password" required>
            <label for="image">Image:
                <input id="image" type="file" name="uploadfile" accept="image/*" />
            </label>
            <input type="submit" value="Register">

        </form>
        <span>If you are logged in, then log in to me <a style="color: gold;" href="/signin">Signin</a> </span>
        <br />
        <span id="notify"> {{ if . }} {{.}} {{end}} </span>
    </div>
</div>
<script>

    const element = document.querySelector('form');
     element.addEventListener('submit', event => {
         event.preventDefault();

         let user = {
             image: null,
             email: '',
             username: '',
             age: '',
             password: '',
             fullname: '',
             type: '',
             sex : '',
             pwd1 : '',
             pwd2 : '',
         };

user.pwd1 = document.getElementById("password1").value;
user.pwd2 = document.getElementById("password2").value;
         user.email = document.getElementById("email").value;
         user.fullname = document.getElementById("fullname").value;
         user.username = document.getElementById("username").value;
         user.age = document.getElementById("age").value;
         user.type = document.getElementById("authType").value;
        user.sex = document.getElementById("sex").value;
         user.image = document.getElementById("image").value;

console.log(user, "ll")
              if (user.email != '' && user.pwd1 != '' && user.pwd2 != '' && user.name != '' && user.username != ''  && user.sex != '' && user.pwd1  != '' && user.pwd2 != '' || user.username && user.password) {
            //async fetch query
            if (user.pwd1 != user.pwd2) {
              console.log("pwd incorrect")
            }
            async function getUserAsync() {
                let response = await fetch('https://forumx.herokuapp.com/signup', {
                    method: 'post',
                    body: JSON.stringify(user),
                });
                let data = await response.json()
                console.log(data, "returned data, promise")
                return data;
            }
         console.log('Form submission cancelled.');
}
     });
</script>
{{end}}